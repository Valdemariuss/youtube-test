!function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){i(1),t.exports=i(3)},function(t,e,i){"use strict";i.r(e);i(2)},function(t,e){class i{constructor(t){t&&(this.box=t,this.init())}init(){this.preload(!0),this.getVideos(),this.getVideosData(),Promise.all(this.promises).then(t=>{this.onInit(),setTimeout(()=>{this.preload(!1)},5e3)})}onInit(){this.createItems(),this.playVideo()}preload(t){t?(this.box.classList.add("_preload"),this.box.innerHTML='<div class="spinner"></div>'):this.box.classList.remove("_preload")}getVideos(){const t=new URLSearchParams(window.location.search.slice(1)).get("id"),e=/[\w\-]{11}/;let i=[];t&&(i=t.split(",").map(t=>t.trim()).filter(t=>e.test(t)&&11===t.length)),this.videosIds=i}ajaxGet(t){return new Promise((e,i)=>{const s=new XMLHttpRequest;let o={success:!1};s.open("GET",t,!0),s.send(),s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status){const t=s.responseText;let e;try{e=JSON.parse(t)}catch(t){}e?(o.success=!0,o.data=e):o.error="No valid response"}else o.error=s.status;e(o)}}})}getVideosData(){this.videos=[],this.promises=[],this.videosIds.forEach(t=>{const e="http://www.youtube.com/watch?v="+t,i="//noembed.com/embed?url="+encodeURIComponent(e),s=this.ajaxGet(i).then(i=>{const s=(i.data||[]).title||"";this.videos.push({id:t,url:e,title:s,img:"//i.ytimg.com/vi/"+t+"/hqdefault.jpg"})});this.promises.push(s)})}createItems(){let t="";this.videos.length?this.videos.forEach(e=>{t+='<div class="youtube-list__item"><div class="youtube-list__box" data-video="'+e.id+'"><div class="youtube-list__preview"><img class="youtube-list__img" src="'+e.img+'">'+(e.title?'<span class="youtube-list__title">'+e.title+"</span>":"")+"</div></div></div>"}):t+='<div class="youtube-list__empty">No videos</div>',this.box.innerHTML+=t}createVideoIframe(t,e){const i="//www.youtube.com/embed/"+t+"?autoplay=1";let s=document.createElement("iframe");return s.setAttribute("class","youtube-list__video"),s.setAttribute("src",i),s.setAttribute("frameborder",0),s.setAttribute("allowfullscreen",""),e&&(s.setAttribute("width",e.width),s.setAttribute("height",e.height)),s}playVideo(){const t=this.box.getElementsByClassName("youtube-list__box"),e=Array.from(t),i=t=>{const e=t.getAttribute("data-video"),i=this.createVideoIframe(e);this.currentVideo&&this.currentVideo.parentNode.removeChild(this.currentVideo),this.currentBox&&this.currentBox.classList.remove("_hide"),t.classList.add("_hide"),t.appendChild(i),this.currentBox=t,this.currentVideo=i};e.forEach(t=>{t.addEventListener("click",()=>{i(t)})})}}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("js-youtube-list");new i(t)})},function(t,e,i){}]);
//# sourceMappingURL=main.js.map